"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[55],{7780:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>t,metadata:()=>c,toc:()=>i});var s=r(4848),a=r(8453);const t={title:"Custom Base Class",description:"Create an extendable Command class"},o=void 0,c={id:"base_class",title:"Custom Base Class",description:"Create an extendable Command class",source:"@site/../docs/base_class.md",sourceDirName:".",slug:"/base_class",permalink:"/docs/oclif/docs/base_class",draft:!1,unlisted:!1,editUrl:"https://github.com/oclif/oclif.github.io/tree/docs/docs/../docs/base_class.md",tags:[],version:"current",lastUpdatedBy:"Mike Donnalley",lastUpdatedAt:1711731567e3,frontMatter:{title:"Custom Base Class",description:"Create an extendable Command class"},sidebar:"docs",previous:{title:"Aliases",permalink:"/docs/oclif/docs/aliases"},next:{title:"Configuring Your CLI",permalink:"/docs/oclif/docs/configuring_your_cli"}},l={},i=[];function d(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Use inheritance to share functionality between common commands. Here is an example of a command base class that has some common shared flags."}),"\n",(0,s.jsx)(n.p,{children:"For large CLIs with multiple plugins, it's useful to put this base class into its own npm package to be shared."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// src/baseCommand.ts\r\nimport {Command, Flags, Interfaces} from '@oclif/core'\r\n\r\nexport type Flags<T extends typeof Command> = Interfaces.InferredFlags<typeof BaseCommand['baseFlags'] & T['flags']>\r\nexport type Args<T extends typeof Command> = Interfaces.InferredArgs<T['args']>\r\n\r\nexport abstract class BaseCommand<T extends typeof Command> extends Command {\r\n  // add the --json flag\r\n  static enableJsonFlag = true\r\n\r\n  // define flags that can be inherited by any command that extends BaseCommand\r\n  static baseFlags = {\r\n    'log-level': Flags.option({\r\n      default: 'info',\r\n      helpGroup: 'GLOBAL',\r\n      options: ['debug', 'warn', 'error', 'info', 'trace'] as const,\r\n      summary: 'Specify level for logging.',\r\n    })(),\r\n  }\r\n\r\n  protected flags!: Flags<T>\r\n  protected args!: Args<T>\r\n\r\n  public async init(): Promise<void> {\r\n    await super.init()\r\n    const {args, flags} = await this.parse({\r\n      flags: this.ctor.flags,\r\n      baseFlags: (super.ctor as typeof BaseCommand).baseFlags,\r\n      enableJsonFlag: this.ctor.enableJsonFlag,\r\n      args: this.ctor.args,\r\n      strict: this.ctor.strict,\r\n    })\r\n    this.flags = flags as Flags<T>\r\n    this.args = args as Args<T>\r\n  }\r\n\r\n  protected async catch(err: Error & {exitCode?: number}): Promise<any> {\r\n    // add any custom logic to handle errors from the command\r\n    // or simply return the parent class error handling\r\n    return super.catch(err)\r\n  }\r\n\r\n  protected async finally(_: Error | undefined): Promise<any> {\r\n    // called after run and catch regardless of whether or not the command errored\r\n    return super.finally(_)\r\n  }\r\n}\r\n\r\n// src/commands/my-command.ts\r\n\r\nexport default class MyCommand extends BaseCommand<typeof MyCommand> {\r\n  static summary = 'child class that extends BaseCommand'\r\n\r\n  static examples = [\r\n    '<%= config.bin %> <%= command.id %>',\r\n    '<%= config.bin %> <%= command.id %> --json',\r\n    '<%= config.bin %> <%= command.id %> --log-level debug',\r\n  ]\r\n\r\n  static flags = {\r\n    name: Flags.string({\r\n      char: 'n',\r\n      summary: 'Name to print.',\r\n      required: true,\r\n    }),\r\n  }\r\n\r\n  public async run(): Promise<Flags<typeof MyCommand>> {\r\n    for (const [flag, value] of Object.entries(this.flags)) {\r\n      this.log(`${flag}: ${value}`)\r\n    }\r\n\r\n    return this.flags\r\n  }\r\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For a more complex example, ",(0,s.jsx)(n.a,{href:"https://github.com/salesforcecli/sf-plugins-core/blob/main/src/sfCommand.ts",children:"here's"})," how we do this for the Salesforce CLI."]})]})}function m(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>c});var s=r(6540);const a={},t=s.createContext(a);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);